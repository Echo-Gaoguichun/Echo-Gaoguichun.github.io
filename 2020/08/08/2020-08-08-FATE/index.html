

<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Federated AI Technology Enable (FATE) - Echo-Gao</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />

  
  
  <meta name="description" content="
@Date：1 February 2019
@Aut..."> 
  
  <meta name="author" content="Echo Gao"> 

  
    <link rel="icon" href="/images/icons/favicon-16x16.png" type="image/png" sizes="16x16">
  
  
    <link rel="icon" href="/images/icons/favicon-32x32.png" type="image/png" sizes="32x32">
  
  
    <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180">
  
  
    <meta rel="mask-icon" href="/images/icons/echo-logo.svg" color="#333333">
  
  
    <meta rel="msapplication-TileImage" content="/images/icons/favicon-144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
  
<link rel="stylesheet" href="//at.alicdn.com/t/font_1445822_0sri83bhiv7.css">

  

  
  
  
<link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
  
  
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/xcode.min.css">

  

  
  
  
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css">

  

  <script>
    var CONFIG = window.CONFIG || {};
    var ZHAOO = window.ZHAOO || {};
    CONFIG = {
      fancybox: true,
      pjax: false,
      lazyload: {
        enable: true,
        loadingImage: '/images/theme/loading.gif',
      },
      donate_alipay: '',
      donate_wechat: '',
      motto: {
        api: '',
        default: '「心有猛虎，细嗅蔷薇」'
      },
      galleries: {
        enable: 'true'
      },
      fab: {
        enable: 'true',
        alwaysShow: 'false'
      },
      carrier: {
        enable: 'true'
      },
      daovoice: {
        enable: 'true'
      }
    }
  </script>

  

  
<meta name="generator" content="Hexo 5.0.0"></head>
<body class="lock-screen">
  <div class="loading"></div>
  <nav class="menu">
  <div class="menu-close">
    <i class="iconfont iconplus"></i>
  </div>
  <ul class="menu-content">
    
    
    
    
    <li class="menu-item"><a href="/ "> 首页</a></li>
    
    
    
    
    <li class="menu-item"><a href="/archives "> 归档</a></li>
    
    
    
    
    <li class="menu-item"><a href="/tags "> 标签</a></li>
    
    
    
    
    <li class="menu-item"><a href="/categories "> 分类</a></li>
    
    
    
    
    <li class="menu-item"><a href="/about "> 关于</a></li>
    
  </ul>
  <div class="menu-copyright"><p>Echo Blog © 2020 | <a target="_blank" href="https://www.gaoguichun.com"> Powered by Hexo</a> </p></div>
</nav>
  <main id="main">
  <div class="container" id="container">
    <article class="article">
  <section class="head">
  <img   class="lazyload" data-original="/2020-08-08-FATE/1.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title">Federated AI Technology Enable (FATE)</h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>2020-08-08</span
        class="post-info-item">
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>23159</span>
    </div>
  </div>
</section>
  <section class="main">
    <section class="content">
      <blockquote>
<p><strong><em>@Date</em></strong>：1 February 2019</p>
<p><strong><em>@Author</em></strong> ：◕‿◕  Echo 戴帽子の鹿 °</p>
<p><strong><em>@Code</em></strong>：<a target="_blank" rel="noopener" href="https://github.com/WeBankFinTech/FATE">https://github.com/WeBankFinTech/FATE</a></p>
</blockquote>
<hr>
<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><h3 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">git clone git@github.com:WeBankFinTech/FATE.git<br></code></pre></td></tr></table></figure>

<blockquote>
<p>Bug :</p>
<img   class="lazyload" data-original="/.com//1.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">
</blockquote>
<blockquote>
<p>Solve:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Shell">cd ~/.ssh<br><span class="hljs-meta">#</span><span class="bash"> check ssh key file</span><br>ls<br></code></pre></td></tr></table></figure>

<img   class="lazyload" data-original="/.com//2.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">ssh-keygen -t rsa -C &quot;youremail@example.com&quot;<br></code></pre></td></tr></table></figure>

<p>​    若遇到输入，直接按回车即可</p>
<img   class="lazyload" data-original="/.com//3.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">ssh -v git@github.com<br></code></pre></td></tr></table></figure>

<p>​    后两行如下</p>
<img   class="lazyload" data-original="/.com//4.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">ssh-agent -s<br></code></pre></td></tr></table></figure>

<img   class="lazyload" data-original="/.com//6.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">ssh-add ~/.ssh/id_rsa<br></code></pre></td></tr></table></figure>

<img   class="lazyload" data-original="/.com//7.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<p>​    一般到这一步就可以，但出现了另一个Bug，执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Shell">eval `ssh-agent -s`<br>ssh-add ~/.ssh/id_rsa<br></code></pre></td></tr></table></figure>

<img   class="lazyload" data-original="/.com//8.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<p>​    SSH Key 生成完毕，将 id_rsa.pub 的内容复制到 github 账号即可。</p>
<p>​    验证 SSH Key</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">ssh -T git@github.com<br></code></pre></td></tr></table></figure>

<img   class="lazyload" data-original="/.com//9.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<p>​    接下来就可以下载啦</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Shell">git clone --recursive git@github.com:WeBankFinTech/FATE.git<br><br></code></pre></td></tr></table></figure>

<img   class="lazyload" data-original="/.com//10.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">
</blockquote>
<h3 id="Standalone"><a href="#Standalone" class="headerlink" title="Standalone"></a>Standalone</h3><ol>
<li><p>Docker version</p>
<ul>
<li><p>Docker for Linux</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Shell">uname -r<br>wget -q0- https://get.docker.com/ | sh<br>sudo service docker start<br><br></code></pre></td></tr></table></figure>
</li>
<li><p>搭建环境</p>
<figure class="highlight sh"><figcaption><span>build_standalone_docker.sh</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">sh build_standalone_docker.sh<br><br></code></pre></td></tr></table></figure>

<blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># copy requirements.txt</span><br>cp requirements.txt ./docker/standalone/  <br><span class="hljs-comment"># location</span><br>git rev-parse HEAD  <br><span class="hljs-comment"># export latest version</span><br>git archive -o ./docker/stangalone/fate.tar $(git rev-parse HEAD) arch/api federatedml workflow examples<br><span class="hljs-comment"># build channel</span><br>docker build --no-cache -t fate/standalone docker/standalone  <br>rm docker/standalone/fate.tar<br>rm docker/standalone/requirements.txt<br><br></code></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta">#</span><span class="bash"> get container ID</span><br>CONTAINER_ID=`docker run -t -d  fate/standalone`<br><span class="hljs-meta">#</span><span class="bash"> login</span><br>docker exec -t -i $&#123;CONTAINER&#125; bash<br><br></code></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Manual version</p>
<ul>
<li><p>MiniConda</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs Shell">wget -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda3-latest-Linux-x86_64.sh <br>bash Miniconda3-latest-Linux-x86_64.sh<br><span class="hljs-meta">#</span><span class="bash"> activate</span><br>source .bashrc <br><span class="hljs-meta">#</span><span class="bash"> add channels</span><br>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free<br>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge<br>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda<br>conda config --set show_channel_urls yes<br><br>conda config --add channels https://mirrors.cloud.tencent.com/anaconda/pkgs/free/<br>conda config --add channels https://mirrors.cloud.tencent.com/anaconda/cloud/bioconda/<br>conda config --add channels https://mirrors.cloud.tencent.com/anaconda/cloud/msys2/<br>conda config --add channels https://mirrors.cloud.tencent.com/anaconda/cloud/menpo/<br>conda config --add channels https://mirrors.cloud.tencent.com/anaconda/cloud/peterjc123/<br>conda config --add channels https://mirrors.cloud.tencent.com/anaconda/pkgs/main/<br>conda config --add channels https://mirrors.cloud.tencent.com/anaconda/cloud/conda-forge/<br>conda config --add channels https://mirrors.cloud.tencent.com/anaconda/cloud/pytorch/<br>conda config --set show_channel_urls yes<br><br>conda config --remove-key channels #默认channels<br><br><span class="hljs-meta">#</span><span class="bash"> create env fate</span><br>conda create -n fate python=3.6.8<br><span class="hljs-meta">#</span><span class="bash"> login fate -- <span class="hljs-built_in">source</span>/conda</span><br>source activate fate<br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">logout</span> fate</span><br>source deactivate fate<br><span class="hljs-meta">#</span><span class="bash"> list all env</span><br> conda env list<br><br></code></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ol>
<ul>
<li><p>Requirements</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta">#</span><span class="bash"> library <span class="hljs-keyword">for</span> fate</span><br>while read requirement; do conda install --yes $requirement; done &lt; requirements.txt   <br><span class="hljs-meta">#</span><span class="bash"> or</span><br>conda install pip<br>pip install -r requirements.txt<br> export PYTHONPATH=`pwd -P`<br><br></code></pre></td></tr></table></figure>

<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim ~/.bashrc<br>export PYTHONPATH=$PYTHONPATH:/home/gao/project/FATE<br><br></code></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<hr>
<h3 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a>Cluster</h3><p><strong>Fate</strong> 也为大数据场景提供了一个分布式运行架构，从 <strong>Standalone</strong> 到 <strong>Cluster</strong> 只需要修改配置文件。</p>
<p><strong>Cluster</strong> deploy guide 见 <a target="_blank" rel="noopener" href="https://github.com/WeBankFinTech/FATE/tree/master/cluster-deploy">https://github.com/WeBankFinTech/FATE/tree/master/cluster-deploy</a></p>
<p>目前我只安装了 <strong>Standalone</strong> ，So 以下的内容只涉及 <strong>Standalone</strong> 。</p>
<hr>
<h3 id="Running-Tests"><a href="#Running-Tests" class="headerlink" title="Running Tests"></a>Running Tests</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Shell">sh ./federatedml/test/run_test.sh<br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>Bug</p>
<img   class="lazyload" data-original="/.com//11.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<p>Solve</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">bash ./federatedml/test/run_test.sh<br><br></code></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> $(dirname <span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span>)  <span class="hljs-comment"># $0 -- value: ./federatedml/test/run_test.sh</span><br><span class="hljs-comment"># get location of .sh file ---- ./federatedml/test</span><br>cur_dir=$(<span class="hljs-built_in">pwd</span>)  <br><br><span class="hljs-function"><span class="hljs-title">run_test</span></span>()&#123;<br>    file=<span class="hljs-variable">$1</span>   <span class="hljs-comment"># $1 -- $file_fullname</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;start to run test &quot;</span><span class="hljs-variable">$file</span><br>    python <span class="hljs-variable">$file</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">traverse_folder</span></span>()&#123;<br>    <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> $(ls <span class="hljs-variable">$&#123;1&#125;</span>);  <span class="hljs-comment"># $1 -- $cur_dir/.. or $filename</span><br>    <span class="hljs-keyword">do</span><br>        file_fullname=<span class="hljs-variable">$1</span>/<span class="hljs-variable">$file</span><br>            <span class="hljs-comment"># -d file ------Is a directory?</span><br>        <span class="hljs-keyword">if</span> [ -d <span class="hljs-variable">$file_fullname</span> ];<span class="hljs-keyword">then</span>              <br>            traverse_folder <span class="hljs-variable">$file_fullname</span><br>        <span class="hljs-comment"># =~ match regular expressions</span><br>        <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$file</span> =~ _test.py$ ]] &amp;&amp; [[ <span class="hljs-variable">$1</span> =~ /<span class="hljs-built_in">test</span>$ ]];<span class="hljs-keyword">then</span><br>            run_test <span class="hljs-variable">$file_fullname</span><br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">done</span><br>&#125;<br><br>traverse_folder <span class="hljs-variable">$cur_dir</span>/..<br><br></code></pre></td></tr></table></figure>

<p>Bug（不一定会出现，后来的安装都没有出现这个Bug）</p>
<img   class="lazyload" data-original="/.com//12.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<p>但是在 conda list 中可以看到</p>
<img   class="lazyload" data-original="/.com//13.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<p>Solve</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Shell">conda uninstall cycler<br>pip uninstall cycler<br>pip install cycler<br><br></code></pre></td></tr></table></figure>

<img   class="lazyload" data-original="/.com//14.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<p>运行的结果是以 start to run test 开头，以 OK 结尾，共有 32 个 _test.py 文件，若都运行成功，表示 <strong>FATE</strong> 安装成功。</p>
<img   class="lazyload" data-original="/.com//15.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  sign="center" width="700">

<p>file : </p>
<ul>
<li>/home/vip25/project/FATE/federatedml/test/../evaluation/test/evaluation_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../feature/test/instance_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../feature/test/quantile_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../feature/test/sparse_vector_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/common_data_util_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/eggroll_encryption_matmul_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/eggroll_encryption_runtime_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/eggroll_encryption_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/eggroll_storage_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/eggroll_X_plus_Y_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/eggroll_XY_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/whitebox_autoencoder_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/whitebox_enc_gradients_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../ftl/test/whitebox_plain_gradients_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../logistic_regression/test/homo_lr_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../logistic_regression/test/logistic_regression_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../loss/test/cross_entropy_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../model_selection/test/KFold_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../model_selection/test/mini_batch_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../optim/federated_aggregator/test/hetero_federated_aggregator_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../optim/gradient/test/hetero_lr_gradient_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../optim/gradient/test/homo_lr_gradient_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../optim/test/convergence_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../optim/test/initialize_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../optim/test/updater_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../secureprotol/test/fate_paillier_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../tree/test/criterion_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../tree/test/feature_histogram_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../tree/test/node_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../util/test/classify_label_checker_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../util/test/data_io_test.py</li>
<li>/home/vip25/project/FATE/federatedml/test/../util/test/param_extract_test.py</li>
</ul>
</blockquote>
<hr>
<h2 id="Example-Programs"><a href="#Example-Programs" class="headerlink" title="Example Programs"></a>Example Programs</h2><h3 id="Start-Programs"><a href="#Start-Programs" class="headerlink" title="Start Programs"></a>Start Programs</h3><p><strong>Fate</strong> 框架中提供了几个 algorithm 的 example 。</p>
<p>以 <strong>homogeneous LR</strong> 为例：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># examples/hemo<span class="hljs-emphasis">_logistic_</span>regression:</span><br>.<br>├── data<br>│   ├── breast<span class="hljs-emphasis">_a.csv</span><br><span class="hljs-emphasis">│   ├── breast_</span>b.csv<br>│   ├── breast<span class="hljs-emphasis">_homo_</span>guest.csv<br>│   ├── breast<span class="hljs-emphasis">_homo_</span>host.csv<br>│   ├── breast<span class="hljs-emphasis">_homo_</span>test.csv<br>│   ├── credit<span class="hljs-emphasis">_data.csv</span><br><span class="hljs-emphasis">│   ├── default_</span>credit<span class="hljs-emphasis">_a.csv</span><br><span class="hljs-emphasis">│   ├── default_</span>credit<span class="hljs-emphasis">_b.csv</span><br><span class="hljs-emphasis">│   ├── default_</span>credit<span class="hljs-emphasis">_homo_</span>guest.csv<br>│   ├── default<span class="hljs-emphasis">_credit_</span>homo<span class="hljs-emphasis">_host.csv</span><br><span class="hljs-emphasis">│   ├── default_</span>credit<span class="hljs-emphasis">_homo_</span>test.csv<br>│   ├── give<span class="hljs-emphasis">_credit_</span>a.csv<br>│   ├── give<span class="hljs-emphasis">_credit_</span>b.csv<br>│   ├── UCI<span class="hljs-emphasis">_Credit_</span>Card.csv<br>│   ├── vehicle<span class="hljs-emphasis">_scale_</span>a.csv<br>│   └── vehicle<span class="hljs-emphasis">_scale_</span>b.csv<br>├── homo<span class="hljs-emphasis">_logistic_</span>regression<br>│   ├── conf<br>│   │   ├── arbiter<span class="hljs-emphasis">_runtime_</span>conf.json<br>│   │   ├── guest<span class="hljs-emphasis">_runtime_</span>conf.json<br>│   │   ├── host<span class="hljs-emphasis">_runtime_</span>conf.json<br>│   │   └── load<span class="hljs-emphasis">_file.json</span><br><span class="hljs-emphasis">│   ├── run_</span>arbiter.sh<br>│   ├── run<span class="hljs-emphasis">_guest.sh</span><br><span class="hljs-emphasis">│   ├── run_</span>host.sh<br>│   ├── run<span class="hljs-emphasis">_logistic_</span>regression.sh<br>│   └── run<span class="hljs-emphasis">_logistic_</span>regression<span class="hljs-emphasis">_standalone.sh</span><br><span class="hljs-emphasis">└── load_</span>file<br><span class="hljs-code">    └── load_file.py</span><br><span class="hljs-code"></span><br></code></pre></td></tr></table></figure>

<p><strong>conf</strong> </p>
<ul>
<li>三个 configuration templates runtime_conf.json  </li>
<li>load_file.json  – loading data into distributed database </li>
</ul>
<hr>
<h3 id="Operational-framework"><a href="#Operational-framework" class="headerlink" title="Operational framework"></a>Operational framework</h3><ul>
<li>./run_logistic_regression_standalone.sh(work_mode,id)</li>
<li>./run_logistic_regression.sh(mode: cv &amp; conf &amp; data_set)<ul>
<li>loadfile(role: guest/host)<ul>
<li>./conf/loadfile.json</li>
<li>../load_file/load_file.py<ul>
<li>read_data (../data/breast_homo_<code>role</code>.csv)<ul>
<li>list_to_str(input_list)</li>
</ul>
</li>
<li>generate_table_name(input_file_path)</li>
<li>data_to_eggroll_table(data) – from arch.api import eggroll<ul>
<li>eggroll.init()<ul>
<li>from arch.api.utils import LoggerFactory<ul>
<li>LoggerFactory.setDirectory()<ul>
<li>file_utils.get_project_base_directory()</li>
</ul>
</li>
</ul>
</li>
<li>from arch.api.utils import file_utils</li>
<li>from arch.api import WorkMode</li>
<li>from arch.api import RuntimeInstance</li>
</ul>
</li>
<li>data_table = eggroll.table()</li>
<li>data_table.put_all()  &amp;  data_table.count()</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>da</li>
</ul>
<hr>
<p><strong>Start a HomoLR program</strong>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Shell">sh run_logistic_regression_standalone.sh<br><br></code></pre></td></tr></table></figure>

<blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> $(dirname <span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span>)  <span class="hljs-comment"># $0 -- value: ./run_logistic_regression_standalone.sh</span><br>curtime=$(date +%Y%m%d%H%M%S)<br>work_mode=0<br>jobid=<span class="hljs-string">&quot;logistic_regression_example_standalone_&quot;</span><span class="hljs-variable">$curtime</span><br>guest_partyid=10000<br>host_partyid=9999<br>arbiter_partyid=10001<br><br>bash run_logistic_regression.sh <span class="hljs-variable">$work_mode</span> <span class="hljs-variable">$jobid</span> <span class="hljs-variable">$guest_partyid</span> <span class="hljs-variable">$host_partyid</span> <span class="hljs-variable">$arbiter_partyid</span><br><br></code></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> $(dirname <span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span>) <span class="hljs-comment"># $0 -- value: ./run_logistic_regression.sh</span><br>work_mode=<span class="hljs-variable">$1</span>       <span class="hljs-comment"># $1 -- $work_mode</span><br>jobid=<span class="hljs-variable">$2</span>           <span class="hljs-comment"># $2 -- $jobid</span><br>guest_partyid=<span class="hljs-variable">$3</span>   <span class="hljs-comment"># $3 -- $guest_partyid</span><br>host_partyid=<span class="hljs-variable">$4</span>    <span class="hljs-comment"># $4 -- $host_partyid</span><br>arbiter_partyid=<span class="hljs-variable">$5</span> <span class="hljs-comment"># $5 -- $arbiter_partyid</span><br><br><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$work_mode</span> -eq 1 ]];<span class="hljs-keyword">then</span><br>    role=<span class="hljs-variable">$6</span>        <span class="hljs-comment"># $6 -- NULL</span><br><span class="hljs-keyword">fi</span><br><br>cur_dir=$(<span class="hljs-built_in">pwd</span>)<br>data_dir=<span class="hljs-variable">$cur_dir</span>/../data<br>load_file_program=<span class="hljs-variable">$cur_dir</span>/../load_file/load_file.py<br>conf_dir=<span class="hljs-variable">$cur_dir</span>/conf<br>log_dir=<span class="hljs-variable">$cur_dir</span>/../../logs<br>load_data_conf=<span class="hljs-variable">$conf_dir</span>/load_file.json<br>guest_runtime_conf=<span class="hljs-variable">$conf_dir</span>/guest_runtime_conf.json<br>host_runtime_conf=<span class="hljs-variable">$conf_dir</span>/host_runtime_conf.json<br>arbiter_runtime_conf=<span class="hljs-variable">$conf_dir</span>/arbiter_runtime_conf.json<br><br>data_set=breast<br>train_data_host=<span class="hljs-variable">$data_dir</span>/<span class="hljs-variable">$&#123;data_set&#125;</span>_homo_host.csv<br>train_data_guest=<span class="hljs-variable">$data_dir</span>/<span class="hljs-variable">$&#123;data_set&#125;</span>_homo_guest.csv<br>predict_data_host=<span class="hljs-variable">$data_dir</span>/<span class="hljs-variable">$&#123;data_set&#125;</span>_home_test.csv<br>predict_data_guest=<span class="hljs-variable">$data_dir</span>/<span class="hljs-variable">$&#123;data_set&#125;</span>_home_test.csv<br>cv_data_host=<span class="hljs-variable">$data_dir</span>/<span class="hljs-variable">$&#123;data_set&#125;</span>_homo_host.csv<br>cv_data_guest=<span class="hljs-variable">$data_dir</span>/<span class="hljs-variable">$&#123;data_set&#125;</span>_homo_guest.csv<br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;data dir is: &quot;</span> <span class="hljs-variable">$data_dir</span><br>mode=cross_validation<br>data_table=<span class="hljs-string">&#x27;&#x27;</span><br>log_file=<span class="hljs-string">&#x27;&#x27;</span><br><br>mkdir -p <span class="hljs-variable">$log_dir</span><br><br><span class="hljs-function"><span class="hljs-title">load_file</span></span>()&#123;<br>    input_path=<span class="hljs-variable">$1</span>  <span class="hljs-comment"># $1 -- $cv_data_guest/$cv_data_guest</span><br>    role=<span class="hljs-variable">$2</span>        <span class="hljs-comment"># $2 -- value: host/geust</span><br>    load_mode=<span class="hljs-variable">$3</span>   <span class="hljs-comment"># $3 -- value: cross_validation</span><br>    conf_path=<span class="hljs-variable">$conf_dir</span>/load_file.json_<span class="hljs-variable">$&#123;role&#125;</span>_<span class="hljs-variable">$&#123;load_mode&#125;</span>_<span class="hljs-variable">$jobid</span><br>    <span class="hljs-comment"># copy load_file.json </span><br>    cp <span class="hljs-variable">$load_data_conf</span> <span class="hljs-variable">$conf_path</span><br>    data_table=<span class="hljs-variable">$&#123;data_set&#125;</span>_<span class="hljs-variable">$&#123;role&#125;</span>_<span class="hljs-variable">$&#123;load_mode&#125;</span>_<span class="hljs-variable">$jobid</span><br>    <span class="hljs-comment"># After the first / number of global search, replace it with the second / number</span><br>    sed -i <span class="hljs-string">&quot;s|_input_path|<span class="hljs-variable">$&#123;input_path&#125;</span>|g&quot;</span><span class="hljs-variable">$&#123;conf_path&#125;</span><br>    sed -i <span class="hljs-string">&quot;s/_table_name/<span class="hljs-variable">$&#123;data_table&#125;</span>/g&quot;</span><span class="hljs-variable">$&#123;conf_path&#125;</span><br>    sed -i <span class="hljs-string">&quot;s/_work_mode/<span class="hljs-variable">$&#123;work_mode&#125;</span>/g&quot;</span><span class="hljs-variable">$&#123;conf_path&#125;</span><br><br>    python <span class="hljs-variable">$load_file_program</span> -c <span class="hljs-variable">$&#123;conf_path&#125;</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">cross_validation</span></span>()&#123;<br>    role=<span class="hljs-variable">$1</span>      <span class="hljs-comment"># $1 -- guest/host/arbiter </span><br>    cv_table=<span class="hljs-variable">$2</span>  <span class="hljs-comment"># $2 -- $cv_table_guest/$cv_table_host</span><br>    runtime_conf=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">if</span>[ <span class="hljs-variable">$role</span> = <span class="hljs-string">&#x27;guest&#x27;</span> ];<span class="hljs-keyword">then</span><br>        runtime_conf=<span class="hljs-variable">$guest_runtime_conf</span><br>    <span class="hljs-keyword">elif</span>[ <span class="hljs-variable">$role</span>=<span class="hljs-string">&#x27;host&#x27;</span> ];<span class="hljs-keyword">then</span><br>        runtime_conf=<span class="hljs-variable">$host_runtime_conf</span><br>    <span class="hljs-keyword">else</span><br>        runtime_conf=<span class="hljs-variable">$arbiter_runtime_conf</span><br>    <span class="hljs-keyword">fi</span><br><br>    cur_runtime_conf=<span class="hljs-variable">$&#123;runtime_conf&#125;</span>_<span class="hljs-variable">$jobid</span><br>    cp <span class="hljs-variable">$runtime_conf</span> <span class="hljs-variable">$cur_runtime_conf</span><br><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;current runtime conf is &quot;</span><span class="hljs-variable">$cur_runtime_conf</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;cv table is &quot;</span><span class="hljs-variable">$cv_table</span><br>    sed -i <span class="hljs-string">&quot;s/_workflow_method/cross_validation/g&quot;</span> <span class="hljs-variable">$cur_runtime_conf</span><br>    sed -i <span class="hljs-string">&quot;s/_cross_validation_table_name/cv_table/g&quot;</span> <span class="hljs-variable">$cur_runtime_conf</span><br>    sed -i <span class="hljs-string">&quot;s/_work_mode/work_mode/g&quot;</span> <span class="hljs-variable">$cur_runtime_conf</span><br>    sed -i <span class="hljs-string">&quot;s/_guest_party_id/guest_party_id/g&quot;</span> <span class="hljs-variable">$cur_runtime_conf</span><br>    sed -i <span class="hljs-string">&quot;s/_host_party_id/host_party_id/g&quot;</span> <span class="hljs-variable">$cur_runtime_conf</span><br>    sed -i <span class="hljs-string">&quot;s/_arbiter_party_id/arbiter_party_id/g&quot;</span> <span class="hljs-variable">$cur_runtime_conf</span><br>    sed -i <span class="hljs-string">&quot;s/_jobid/jobid/g&quot;</span> <span class="hljs-variable">$cur_runtime_conf</span><br><br>    log_file=<span class="hljs-variable">$&#123;log_dir&#125;</span>/<span class="hljs-variable">$&#123;jobid&#125;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Please check log file in &quot;</span><span class="hljs-variable">$&#123;log_file&#125;</span><br>    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$role</span> == <span class="hljs-string">&#x27;guest&#x27;</span> ];<span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;enter guest&quot;</span><br>        <span class="hljs-comment"># nohup -- Ignore hangup signal ;  &amp; -- run code in the background</span><br>        nohup bash run_guest.sh <span class="hljs-variable">$cur_runtime_conf</span> <span class="hljs-variable">$jobid</span> &gt; nohup.guest &amp;<br>    <span class="hljs-keyword">elif</span> [ <span class="hljs-variable">$role</span> == <span class="hljs-string">&#x27;arbiter&#x27;</span> ];<span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;enter arbiter&quot;</span><br>        nohup bash run_arbiter.sh <span class="hljs-variable">$cur_runtime_conf</span> <span class="hljs-variable">$jobid</span> &gt; nohup.arbiter &amp;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;enter host&quot;</span><br>        nohup bash run_host.sh <span class="hljs-variable">$cur_runtime_conf</span> <span class="hljs-variable">$jobid</span> &gt; nohup.host &amp; <br>    <span class="hljs-keyword">fi</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">get_log_rusult</span></span>()&#123;<br> <br>&#125; <br><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$mode</span> = <span class="hljs-string">&#x27;train&#x27;</span> ];<span class="hljs-keyword">then</span><br>    ...<br><span class="hljs-keyword">elif</span> [ <span class="hljs-variable">$mode</span> = <span class="hljs-string">&#x27;cross_validation&#x27;</span> ];<span class="hljs-keyword">then</span><br>    <span class="hljs-keyword">if</span>[[ <span class="hljs-variable">$work_mode</span> -eq 0 ]];<span class="hljs-keyword">then</span><br>        load_file <span class="hljs-variable">$cv_data_guest</span> guest cross_validation<br>        cv_table_guest=<span class="hljs-variable">$data_table</span><br>        load_file <span class="hljs-variable">$cv_data_host</span> host cross_validation<br>        cv_table_host=<span class="hljs-variable">$data_table</span><br>        <br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;cv table guest is: &quot;</span><span class="hljs-variable">$cv_table_guest</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;cv table host is: &quot;</span><span class="hljs-variable">$cv_table_host</span><br><br></code></pre></td></tr></table></figure>


</blockquote>
<hr>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><h3 id="conf-load-file-json"><a href="#conf-load-file-json" class="headerlink" title="./conf/load_file.json"></a>./conf/load_file.json</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;file&quot;</span>:<span class="hljs-string">&quot;_input_path&quot;</span>,<br>    <span class="hljs-attr">&quot;head&quot;</span>:<span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;partition&quot;</span>:<span class="hljs-number">10</span>,<br>    <span class="hljs-attr">&quot;table_name&quot;</span>:<span class="hljs-string">&quot;_table_name&quot;</span>,<br>    <span class="hljs-attr">&quot;namespace&quot;</span>:<span class="hljs-string">&quot;example_data_namespace&quot;</span>,<br>    <span class="hljs-attr">&quot;work_mode&quot;</span>:_work_mode<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="load-file-load-file-py"><a href="#load-file-load-file-py" class="headerlink" title="../load_file/load_file.py"></a>../load_file/load_file.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> argparse<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> traceback<br><span class="hljs-keyword">import</span> csv<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> arch.api <span class="hljs-keyword">import</span> eggroll<br><br>MAX_PARTITION_NUM = <span class="hljs-number">32</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">list_to_str</span>(<span class="hljs-params">input_list</span>):</span><br>    str1 = <span class="hljs-string">&#x27;&#x27;</span><br>    size = len(input_list)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(size):<br>        <span class="hljs-keyword">if</span> i == size - <span class="hljs-number">1</span>:<br>            str1 += str(input_list[i])<br>        <span class="hljs-keyword">else</span>:<br>            str1 += str(input_list[i])+<span class="hljs-string">&#x27;,&#x27;</span><br>    <span class="hljs-keyword">return</span> str1<br><br><span class="hljs-comment"># input_file -- value: ../data/breast_homo_guest.csv</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">input_file,head</span>):</span><br>    split_file_name = input_file.split(<span class="hljs-string">&#x27;.&#x27;</span>)<br>    <span class="hljs-keyword">if</span> CSV <span class="hljs-keyword">in</span> split_file_name:<br>        print(<span class="hljs-string">&quot;file type is CSV&quot;</span>)<br>        <span class="hljs-keyword">with</span> open(input_file) <span class="hljs-keyword">as</span> csv_file:<br>            csv_reader = csv.reader(csv_file)<br>            <span class="hljs-keyword">if</span> head <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:<br>                csv_head = next(csv_reader)<br>                <br>            <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> csv_reader:<br>                <span class="hljs-comment"># yield -- 类似迭代器</span><br>                <span class="hljs-keyword">yield</span>(row[<span class="hljs-number">0</span>],list_to_str(row[<span class="hljs-number">1</span>:]))<br><br><span class="hljs-comment"># input_file_path -- value: ../data/breast_homo_guest.csv                </span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_table_name</span>(<span class="hljs-params">input_file_path</span>):</span><br>    local_time = time.localtime(time.time())<br>    str_time = time.strftime(<span class="hljs-string">&quot;%Y%m%d%H%M%S&quot;</span>,time.localtime())<br>    file_name = input_file_path.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]<br>    file_name = file_name.split(<span class="hljs-string">&#x27;/&#x27;</span>)[<span class="hljs-number">-1</span>]<br>    <span class="hljs-keyword">return</span> file_name,str_time<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">data_to_eggroll_data</span>(<span class="hljs-params">data,namespace,table_name,partition=<span class="hljs-number">1</span>,work_mode=<span class="hljs-number">0</span></span>):</span><br>    eggroll.init(mode=work_mode)<br>    data_table = eggroll.table(table_name,namespace,partition=partition,create_if_missing=<span class="hljs-literal">True</span>,error_if_exist=<span class="hljs-literal">False</span>)<br>    data_table.put_all(data)<br>    data_table_count = data_table.count()<br>    print(<span class="hljs-string">&quot;---------------------load data finish!---------------------&quot;</span>)<br>    print(<span class="hljs-string">&quot;total data_count: &quot;</span>+str(data_table.count()))<br>    print(<span class="hljs-string">&quot;namespace:%s, table_name:%s &quot;</span> % (namespzce,table_name))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    parser = argparse.ArgumentParser()<br>    parser.add_asgument(<span class="hljs-string">&#x27;-c&#x27;</span>,<span class="hljs-string">&#x27;--config&#x27;</span>,required=<span class="hljs-literal">False</span>,type=str,help=<span class="hljs-string">&quot;指定一个配置文件路径(json格式)&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        args = parser.parse_args()<br>        <span class="hljs-comment"># args.config -- value: $*.json_$&#123;role&#125;_$&#123;load_mode&#125;_$jobid</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> args.config:<br>            print(<span class="hljs-string">&quot;找不到配置文件&quot;</span>)<br>            sys.exit()<br>        data = &#123;&#125;<br>        <span class="hljs-keyword">try</span>:<br>            args.config = os.path.abspath(args.config)<br>            input_file_path = <span class="hljs-literal">None</span><br>            head = <span class="hljs-literal">True</span><br>            table_name = <span class="hljs-literal">None</span><br>            namespace = <span class="hljs-literal">None</span><br>            <span class="hljs-keyword">with</span> open(args.config,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                data = json.load(f)<br>                <br>                <span class="hljs-keyword">try</span>:<br>                    input_file_path = data[<span class="hljs-string">&#x27;file&#x27;</span>]<br>                <span class="hljs-keyword">except</span>:<br>                    traceback.print_exc()<br>                    <br>                <span class="hljs-keyword">try</span>:<br>                    read_head = data[<span class="hljs-string">&#x27;head&#x27;</span>]<br>                    <span class="hljs-keyword">if</span> read_head == <span class="hljs-number">0</span>:<br>                        head = <span class="hljs-literal">False</span><br>                    <span class="hljs-keyword">elif</span> read_head == <span class="hljs-number">1</span>:<br>                        head = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">except</span>:<br>                    print(<span class="hljs-string">&quot;&#x27;head&#x27; in .json should be 0 or 1,set head to 1&quot;</span>)<br>                    <br>                <span class="hljs-keyword">try</span>:<br>                    partition = data[<span class="hljs-string">&#x27;partition&#x27;</span>]<br>                    <span class="hljs-keyword">if</span> partition &lt;=<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> partition &gt; MAX_PARTITION_NUM:<br>                        print(<span class="hljs-string">&quot;Error number of partittion, it should between %d and %d&quot;</span> % (<span class="hljs-number">0</span>,MAX_PARTITION_NUM))<br>                        sys.exit()<br>                <span class="hljs-keyword">except</span>:<br>                    print(<span class="hljs-string">&quot;set partition to 1&quot;</span>)<br>                    partition = <span class="hljs-number">1</span><br>                    <br>                <span class="hljs-keyword">try</span>:<br>                    table_name = data[<span class="hljs-string">&#x27;table_name&#x27;</span>]<br>                <span class="hljs-keyword">except</span>:<br>                    print(<span class="hljs-string">&quot;not setting table_name or setting error, set table_name according to current time&quot;</span>)<br>                    <br>                <span class="hljs-keyword">try</span>:<br>                    namespace = data[<span class="hljs-string">&#x27;namespace&#x27;</span>]<br>                <span class="hljs-keyword">except</span>:<br>                    print(<span class="hljs-string">&quot;not setting namespace pr setting error, set namespace according to input file name&quot;</span>)<br>                    <br>                work_mode = data.get(<span class="hljs-string">&#x27;work_mode&#x27;</span>)<br>                <span class="hljs-keyword">if</span> work_mode <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>：<br>                    work_mode = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.parth.exists(input_file_path):<br>                print(<span class="hljs-string">&quot;%s is not exist, please check the configure&quot;</span> % (input_file_path))<br>                sys.exit()<br>                <br>            <span class="hljs-comment"># input_file_path -- value: ../data/breast_homo_guest.csv</span><br>            input_data = read_data(input_file_path,head)<br>            _namespace,_table_name = generate_table_name(input_file_path)<br>            <span class="hljs-keyword">if</span> namespace <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                namespace = _namespace<br>            <span class="hljs-keyword">if</span> table_naem <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                table_name = _table_name<br>            data_to_eggroll_table(input_data, namespace, table_name, partition, work_name)<br>        <span class="hljs-keyword">except</span> ValueError:<br>            print(<span class="hljs-string">&#x27;json 解析错误&#x27;</span>)<br>            exit(<span class="hljs-number">-102</span>)<br>        <span class="hljs-keyword">except</span> IOError:<br>            print(<span class="hljs-string">&#x27;文件读取错误&#x27;</span>)<br>            exit(<span class="hljs-number">-103</span>)<br>    <span class="hljs-keyword">except</span>:<br>        tracebace.print_exc()<br><br></code></pre></td></tr></table></figure>

<h3 id="arch-api-eggroll-py"><a href="#arch-api-eggroll-py" class="headerlink" title="../../arch/api/eggroll.py"></a>../../arch/api/eggroll.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> uuid<br><span class="hljs-keyword">from</span> arch.api.utils.log_utils <span class="hljs-keyword">import</span> LoggerFactory<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> arch.api <span class="hljs-keyword">import</span> WorkMode,RuntimeInstance<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init</span>(<span class="hljs-params">job_id=None,mode: WorkMode = WorkMode.STANDALONE</span>):</span><br>    <span class="hljs-keyword">if</span> job_id <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-comment"># uuid是128位的全局唯一标识符 uuid.uuid1() 可以保证全球范围内的唯一性 </span><br>        job_id = str(uuid.uuid1())<br>        LoggerFactory.setDirectory()<br>    <span class="hljs-keyword">else</span>:<br>        LoggerFactory.setDirectory(os.path.join( file_utils.get_project_base_dictory(), <span class="hljs-string">&#x27;logs&#x27;</span>, job_id))<br>    RuntimeInstance.MODE = mode<br>    <span class="hljs-keyword">if</span> mode == WorkMode.STANDALONE:<br>        <span class="hljs-keyword">from</span> arch.api.standalone.eggroll <span class="hljs-keyword">import</span> Standalone<br>        RuntimeInstance.EGGROLL = Standalone(job_id=job_id)<br><br></code></pre></td></tr></table></figure>

<h3 id="arch-api-init-py"><a href="#arch-api-init-py" class="headerlink" title="../../arch/api/__init__.py"></a>../../arch/api/__init__.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> IntEnum,Enum<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WorkMode</span>(<span class="hljs-params">IntEnum</span>):</span><br>    STANDALONE = <span class="hljs-number">0</span><br>    CLUSTER = <span class="hljs-number">1</span><br>    SIMPLE = <span class="hljs-number">2</span><br>    <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RuntimeInstance</span>(<span class="hljs-params">object</span>):</span><br>    EGGROLL = <span class="hljs-literal">None</span><br>    MODE = <span class="hljs-literal">None</span><br>    FEDERATION = <span class="hljs-literal">None</span><br>    <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StoreType</span>(<span class="hljs-params">Enum</span>):</span><br>    IN_MEMORY = <span class="hljs-string">&quot;IN_MEMORY&quot;</span><br>    LMDB = <span class="hljs-string">&quot;LMDB&quot;</span><br><br></code></pre></td></tr></table></figure>

<h3 id="arch-api-utils-log-utils-py"><a href="#arch-api-utils-log-utils-py" class="headerlink" title="../../arch/api/utils/log_utils.py"></a>../../arch/api/utils/log_utils.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">import</span> logging.handlers <span class="hljs-keyword">import</span> TimedRotatingFileHandler<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> threading <span class="hljs-keyword">import</span> RLock<br><span class="hljs-keyword">from</span> arch.api.utils <span class="hljs-keyword">import</span> file_utils <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoggerFactory</span>(<span class="hljs-params">object</span>):</span><br>    TYPE = <span class="hljs-string">&#x27;FILE&#x27;</span><br>    LEVEL = logging.DEBUG<br>    loggerDict = &#123;&#125;<br>    LOG_DIR = <span class="hljs-literal">None</span><br>    <span class="hljs-comment"># RLock允许在同一线程中被多次acquire; acquire和release必须成对出现</span><br>    lock = RLock()<br>    <br>    <span class="hljs-comment"># @staticmethod修饰的方法定义与普通函数是一样的</span><br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setDirectory</span>(<span class="hljs-params">directory=None</span>):</span><br>        <span class="hljs-keyword">with</span> LoggerFactory.lock:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> directory:<br>                dictory = os.path.join(file_utils.get_project_base_directory(), <span class="hljs-string">&#x27;logs&#x27;</span>)<br>            LoggerFactory.LOG_DIR = dictory<br>            os.makedirs(LoggerFactory.LOG_DIR,exist_ok=<span class="hljs-literal">True</span>)<br>            <span class="hljs-keyword">for</span> classname,(logger,handler) <span class="hljs-keyword">in</span> LoggerFactory.loggerDict.items():<br>                logger.removeHandler(handler)<br>                handler.close()<br>                _handler = LoggerFactory.__get_handler(classname)<br>                logger.addHandler(_handler)<br>                LoggerFactory.loggerDict[classname]=logger,_handler<br>                <br>                <br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__get_handler</span>(<span class="hljs-params">className</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> LoggerFactory.LOG_DIR:<br>            <span class="hljs-keyword">return</span> logging.StreamHandler()<br>        formatter = logging.Formatter(<span class="hljs-string">&#x27;&quot;%(asctime)s - %(filename)s[line:%(lineno)d] - %(levelname)s:%(message)s&quot;&#x27;</span>)<br>        log_file = os.path.join(LoggerFactory.LOG_DIR,<span class="hljs-string">&quot;&#123;&#125;.log&quot;</span>.format(classname))<br>        hander = TimedRotatingFileHandler(log_file,<br>                                          when=<span class="hljs-string">&#x27;H&#x27;</span>,<br>                                          interval=<span class="hljs-number">4</span>,<br>                                          backupCount=<span class="hljs-number">7</span>,<br>                                          delay=<span class="hljs-literal">True</span>)<br>        handler.setFormatter(formatter)<br>        <span class="hljs-keyword">return</span> handder<br>            <br><br></code></pre></td></tr></table></figure>

<h3 id="arch-api-utils-file-utils-py"><a href="#arch-api-utils-file-utils-py" class="headerlink" title="../../arch/api/utils/file_utils.py"></a>../../arch/api/utils/file_utils.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_project_base_directory</span>():</span><br>    <span class="hljs-keyword">global</span> PROJECT_BASE<br>    <span class="hljs-keyword">if</span> PROJECT_BASE <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-comment"># 获得文件当前路径os.path.abspath</span><br>        <span class="hljs-comment"># 获得文件的父目录os.path.dirname</span><br>        <span class="hljs-comment"># 先处理符号链接，再返回绝对路径os.path.realpath</span><br>        PROJECT_BASE = os.path.abspath(<br>            os.path.join(os.path.dirname(os.path.realpath(__file__)), os.pardir,os.pardir,os.pardir))<br>    <span class="hljs-keyword">return</span> PROJECT_BASE<br><br></code></pre></td></tr></table></figure>



<h3 id="arch-api-init-py-1"><a href="#arch-api-init-py-1" class="headerlink" title="../../arch/api/__init__.py"></a>../../arch/api/__init__.py</h3><h3 id="arch-api-standalone-eggroll-py"><a href="#arch-api-standalone-eggroll-py" class="headerlink" title="../../arch/api/standalone/eggroll.py"></a>../../arch/api/standalone/eggroll.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> uuid<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Standalone</span>:</span><br>    __instance = <span class="hljs-literal">None</span><br>    <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self,job_id=None</span>):</span><br>        self.data_dir = os.path.join(file_utils.get_project_base_directory(),<span class="hljs-string">&#x27;data&#x27;</span>)<br>        self.job_id = str(uuid.uuid1())<br><br></code></pre></td></tr></table></figure>



<h3 id="run-guest-sh"><a href="#run-guest-sh" class="headerlink" title="./run_guest.sh"></a>./run_guest.sh</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> $(dirname <span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span>)  <span class="hljs-comment"># $0 -- value: ./run_guest.sh</span><br>config_path=<span class="hljs-variable">$1</span>      <span class="hljs-comment"># $1 -- $cur_runtime_conf</span><br>jobid=<span class="hljs-variable">$2</span>            <span class="hljs-comment"># $2 -- $jobid</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;config path is &quot;</span><span class="hljs-variable">$config_path</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;jobid is &quot;</span><span class="hljs-variable">$jobid</span><br><br>python ../../workflow/home_lr_workflow/home_guest_workflow.py -c <span class="hljs-variable">$config_path</span> -j <span class="hljs-variable">$jobid</span><br><br></code></pre></td></tr></table></figure>



<h2 id="My-Experiment"><a href="#My-Experiment" class="headerlink" title="My Experiment"></a>My Experiment</h2><h3 id="Adult"><a href="#Adult" class="headerlink" title="Adult"></a>Adult</h3><table>
<thead>
<tr>
<th align="center">Model</th>
<th align="center">Precision</th>
<th align="center">AUC</th>
</tr>
</thead>
<tbody><tr>
<td align="center">XGboost</td>
<td align="center">0.8638</td>
<td align="center">0.7706</td>
</tr>
<tr>
<td align="center">LR</td>
<td align="center">0.8229</td>
<td align="center">0.6925</td>
</tr>
<tr>
<td align="center">FL+LR Guest</td>
<td align="center">0.69</td>
<td align="center">0.7988</td>
</tr>
<tr>
<td align="center">FL+LR Host</td>
<td align="center">0.678</td>
<td align="center">0.5834</td>
</tr>
</tbody></table>
<h3 id="Mimic-III"><a href="#Mimic-III" class="headerlink" title="Mimic III"></a>Mimic III</h3>
    </section>
    <section class="extra">
      
        <ul class="copyright">
  
  <li><strong>本文作者：</strong>Echo Gao</li>
  <li><strong>本文链接：</strong><a href="http://gaoguichun.com/2020/08/08/2020-08-08-FATE/index.html">http://gaoguichun.com/2020/08/08/2020-08-08-FATE/index.html</a></li>
  <li><strong>版权声明：</strong>本博客所有文章均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"
      rel="external nofollow" target="_blank"> BY-NC-SA </a>许可协议，转载请注明出处！</li>
  
</ul>
      
      
      
  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/FATE/" rel="tag">FATE</a></li></ul>

      
<nav class="nav">
  
  
    <a href="/2020/08/08/hello-world/">Hello World<i class="iconfont iconright"></i></a>
  
</nav>

    </section>
    
      <section class="comments">
        
          <div class="btn" id="comments-btn">查看评论</div>
        
        
      </section>
    
  </section>
</article>
  </div>
</main>
  <footer class="footer">
  <div class="footer-social">
    
    
    
    
    
    <a href="tencent://message/?Menu=yes&uin= " target="_blank" onMouseOver="this.style.color= '#12B7F5'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  iconQQ "></i>
    </a>
    
    
    
    
    
    <a href="javascript:; " target="_blank" onMouseOver="this.style.color= '#09BB07'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  iconwechat-fill "></i>
    </a>
    
    
    
    
    
    <a href="https://github.com/echo-gaoguichun " target="_blank" onMouseOver="this.style.color= '#24292E'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  icongithub-fill "></i>
    </a>
    
    
    
    
    
    <a href="mailto:gao_guichun@163.com " target="_blank" onMouseOver="this.style.color='#FFBE5B'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  iconmail"></i>
    </a>
    
  </div>
  <div class="footer-copyright"><p>Echo Blog © 2020 | <a target="_blank" href="https://www.gaoguichun.com"> Powered by Hexo</a> </p></div>
</footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  
  <div class="fab fab-daovoice">
    <i class="iconfont iconcomment"></i>
  </div>
  
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  <div class="fab fab-menu">
    <i class="iconfont iconmenu"></i>
  </div>
  
</body>


<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>






<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>








<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>






<script src="https://cdn.bootcdn.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js"></script>






  <script defer>
  (function (i, s, o, g, r, a, m) {
    i["DaoVoiceObject"] = r;
    i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o), m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    a.charset = "utf-8";
    m.parentNode.insertBefore(a, m)
  })(window, document, "script", ('https:' == document.location.protocol ? 'https:' : 'http:') +
    "//widget.daovoice.io/widget/0f81ff2f.js", "daovoice")
  daovoice('init', {
    app_id: "a7794e2b"
  }, {
    launcher: {
      disableLauncherIcon: true,
    },
  });
  daovoice('update');
</script>



<script src="/js/utils.js"></script>
<script src="/js/zui.js"></script>
<script src="/js/script.js"></script>



<script>
  (function () {
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    } else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>











</html>